<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Binding.scala</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">mybatis-scala-core</a> &gt; <a href="index.source.html" class="el_package">org.mybatis.scala.mapping</a> &gt; <span class="el_source">Binding.scala</span></div><h1>Binding.scala</h1><pre class="source lang-java linenums">/**
 *    Copyright 2011-2015 the original author or authors.
 *
 *    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 */
package org.mybatis.scala.mapping

<span class="nc" id="L18">sealed class ParamModeEnum(v : String) {</span>
<span class="nc" id="L19">  override def toString : String = v</span>
}

<span class="nc" id="L22">case object ModeIN extends ParamModeEnum(&quot;IN&quot;)</span>
<span class="nc" id="L23">case object ModeOUT extends ParamModeEnum(&quot;OUT&quot;)</span>
<span class="nc" id="L24">case object ModeINOUT extends ParamModeEnum(&quot;INOUT&quot;)</span>

/** Provides compile time checked inline parameter bindings.
  * == Syntax ==
  * General notation
  * {{{
  *   {?[T](propertyName, jdbcType=DBT, typeHandler=T[TH], mode=MD, numericScale=NS, resultMap=RM)}
  * }}}
  * Where
  * {{{
  *  - T                : JavaType      : Type of the parameter property, Optional
  *  - propertyName     : String        : Name of the parameter property, Required
  *  - DBT              : JdbcType      : Any value of org.mybatis.scala.mapping.JdbcType, Optional
  *  - TH               : TypeHandler   : A TypeHandler implementation class, Optional
  *  - MD               : ParamModeEnum : Any of (ModeIN, ModeOUT, ModeINOUT), Optional
  *  - NS               : Int           : Numeric Scale, Optional
  *  - RM               : ResultMap     : A ResultMap Object, Optional
  * }}}
  *
  * Simplified Notation
  * If you need to specify only the property name, you ca use this simplified notation:
  * {{{
  *   {propertyName?}
  * }}}
  *
  * == Code Examples ==
  * {{{
  *   &lt;xsql&gt;
  *      SELECT * FROM person
  *      WHERE name = {&quot;name&quot;?}
  *   &lt;/xsql&gt;
  * }}}
  *
  * {{{
  *   &lt;xsql&gt;
  *      SELECT * FROM task
  *      WHERE due_date = {?(&quot;date&quot;, typeHandler=T[JodaTimeTypeHandler])}
  *   &lt;/xsql&gt;
  * }}}
  *
  */
object Binding {  

  /** Custom Aliased Types */
<span class="nc" id="L68">  private val valueTypes = Set(&quot;byte&quot;, &quot;long&quot;, &quot;short&quot;, &quot;int&quot;, &quot;double&quot;, &quot;float&quot;, &quot;boolean&quot;,</span>
<span class="nc" id="L69">    &quot;byte[]&quot;, &quot;long[]&quot;, &quot;short[]&quot;, &quot;int[]&quot;, &quot;double[]&quot;, &quot;float[]&quot;, &quot;boolean[]&quot;)</span>

  /** Custom alias translator */
  private def translate(cls : Class[_]) : String = {
<span class="nc bnc" id="L73" title="All 2 branches missed.">    if (valueTypes contains cls.getSimpleName) &quot;_&quot; + cls.getSimpleName</span>
<span class="nc" id="L74">    else cls.getName</span>
  }

  /** Generates an inline parameter binding */
  def ?[JavaType : Manifest] (
    property : String,
<span class="nc" id="L80">    jdbcType : JdbcType = null,</span>
<span class="nc" id="L81">    jdbcTypeName : String = null,</span>
<span class="nc" id="L82">    numericScale : Int = 0,</span>
<span class="nc" id="L83">    mode : ParamModeEnum = ModeIN,</span>
<span class="nc" id="L84">    typeHandler : T[_ &lt;: TypeHandler[_]] = null,</span>
<span class="nc" id="L85">    resultMap : ResultMap[_] = null</span>
  ) : String = {  
<span class="nc" id="L87">    Seq[Option[String]](</span>
<span class="nc" id="L88">      Some(property)</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">      ,if (jdbcType != null) Some(&quot;jdbcType=&quot; + jdbcType.toString) else None</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">      ,if (jdbcTypeName != null) Some(&quot;jdbcTypeName=&quot; + jdbcTypeName) else None</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">      ,if (numericScale != 0) Some(&quot;numericScale=&quot; + numericScale) else None</span>
<span class="nc bnc" id="L92" title="All 6 branches missed.">      ,if (mode != ModeIN) Some(&quot;mode=&quot; + mode.toString) else None</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">      ,if (typeHandler != null) Some(&quot;typeHandler=&quot; + typeHandler.unwrap.getName) else None</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">      ,if (resultMap != null) Some(&quot;resultMap=&quot; + resultMap.fqi.id) else None</span>
      ,{
<span class="nc" id="L96">        val t = manifest[JavaType].runtimeClass</span>
<span class="nc bnc" id="L97" title="All 6 branches missed.">        if (t != classOf[Nothing]) Some(&quot;javaType=&quot; + translate(t)) else None</span>
      }
<span class="nc bnc" id="L99" title="All 4 branches missed.">      ) filter {_ match {case Some(x) =&gt; true; case None =&gt; false }} map {_.get} mkString(&quot;#{&quot;, &quot;,&quot;, &quot;}&quot;)</span>
  }

  /** Utility class for simplified syntax support */
<span class="nc" id="L103">  implicit class Param(property : String) {</span>
<span class="nc" id="L104">    def ? = Binding ? (property)</span>
  }

  /** Implicit conversion for simplified syntax support */
  //implicit def StringToParam(s : String) = new Param(s)

<span class="nc" id="L110">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>